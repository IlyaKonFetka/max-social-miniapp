ИНСТРУКЦИЯ ПО ТЕСТИРОВАНИЮ СВЯЗИ ФРОНТЕНД-БЭКЕНД
=================================================

1. ЗАПУСК БЭКЕНДА

   cd backend
   python seed_data.py    # Создать тестовые данные (волонтёров)
   python main.py         # Запустить API сервер

   Бэкенд запустится на http://localhost:8080


2. НАСТРОЙКА NGROK (для доступа с GitHub Pages)

   ngrok http 8080

   Скопируйте URL (например: https://6f19-188-170-58-226.ngrok-free.app)


3. ОБНОВЛЕНИЕ КОНФИГА

   Отредактируйте файл config.json:
   {
     "apiBaseUrl": "https://YOUR-NGROK-URL.ngrok-free.app"
   }

   Замените YOUR-NGROK-URL на ваш URL из ngrok


4. ЛОКАЛЬНОЕ ТЕСТИРОВАНИЕ

   Вариант А - через тестовую страницу:
   
   Откройте в браузере: http://localhost:8000/test-api.html
   
   Нажмите все кнопки по порядку:
   - GET /health - проверка API
   - GET /api/stats/overview - статистика
   - POST /api/call-requests - создание запроса
   - GET /api/volunteers/available - список волонтёров
   - Запустить полный тест - полный цикл

   Вариант Б - через основное приложение:
   
   Откройте: http://localhost:8000/index.html
   
   1. Проверьте статус подключения (должно быть "API подключен")
   2. Выберите тип помощи
   3. Нажмите "Позвать волонтёра"
   4. Дождитесь подключения к волонтёру
   5. Завершите звонок

   В консоли браузера (F12) смотрите логи:
   - API URL загружен
   - Запрос создан
   - Сессия создана
   - Сессия завершена


5. ТЕСТИРОВАНИЕ С GITHUB PAGES

   git add .
   git commit -m "Add API integration"
   git push

   Откройте: https://YOUR-USERNAME.github.io/max-social-case-miniapp/

   Убедитесь что в config.json указан ngrok URL!


6. TROUBLESHOOTING

   Ошибка "API недоступен":
   - Проверьте что бэкенд запущен (http://localhost:8080/docs)
   - Проверьте что ngrok запущен
   - Проверьте URL в config.json

   CORS ошибка:
   - Бэкенд уже настроен на allow_origins=["*"]
   - Перезапустите бэкенд если изменили настройки

   Нет волонтёров:
   - Запустите: python seed_data.py

   Ошибка в консоли:
   - Откройте DevTools (F12)
   - Вкладка Console - смотрите ошибки
   - Вкладка Network - смотрите HTTP запросы


7. ПРОВЕРКА ЗАПРОСОВ В SWAGGER

   Откройте: http://localhost:8080/docs
   
   Или через ngrok: https://YOUR-NGROK-URL.ngrok-free.app/docs

   Попробуйте выполнить запросы вручную:
   - GET /health
   - GET /api/volunteers/available
   - POST /api/call-requests


8. БАЗА ДАННЫХ

   Adminer: http://localhost:8081
   
   Логин:
   - Сервер: postgres
   - Пользователь: miniapp_user
   - Пароль: miniapp_password
   - База: miniapp_db

   Можете посмотреть созданные запросы и сессии в таблицах.


ГОТОВО! Теперь фронтенд полноценно общается с бэкендом.

